@model BussinessObjects.Models.Dtos.ClubDetailsViewDto
@using System.Security.Claims
@inject IHttpContextAccessor HttpContextAccessor

@{
	ViewData["Title"] = "Details";
	var username = User.FindFirst(ClaimTypes.Name)?.Value;
	
}

<link rel="stylesheet" href="~/css/club-details.css">
<section class="banner">
	<div class="container">
		<div class="banner-img d-flex justify-content-center">
				<div>
					<img src="@(string.IsNullOrEmpty(Model.CoverBase64) ? Url.Content("~/defaultImage.jpg") : Model.CoverBase64)"
						 alt="Cover picture"
						 class="img-fluid"
						 style="width: 1000px; height: 500px">
				</div>
		</div>

		<div class="row">
			<div class="col-lg-12">
				<div class="banner-content text-center">
					@* <div class="meta-cat"> *@
					@* 	<span class="text-capitalize letter-spacing-1 cat-name font-extra text-color">Travel</span> *@
					@* </div> *@
					<div class="post-title">
						<h2>@Model.ClubName</h2>
					</div>

					@* Statistic here: Member, post, event count*@
					<div class="post-meta footer-meta">
						<ul class="list-inline">
							<li class="post-like list-inline-item">
								<span class="count">@Model.ClubMembers.Count</span> Members
							</li>
							<li class="post-read list-inline-item">@Model.Posts.Count Posts</li>
						</ul>
					</div>
					<div class="post-content">
			
						<div class="avatar-list">

							@for (int i = 0; i < Model.ClubMembers.Count && i < 10; i++)
							{
								var member = Model.ClubMembers[i];
								<div class="avatar">
									<img src="@(member.ProfilePictureBase64)" alt="@member.Username">
									<span class="username">@member.Username</span>
								</div>
							}

						</div>

					</div>
				</div>
			</div>
		</div>
	</div>
</section>





<section class="section-padding pt-4">
	<div class="container">
		<div class="row">
			<div class="col-lg-8 col-md-12 col-sm-12 col-xs-12">

				<article class="post-list mb-5 pb-4 border-bottom">
					<a class="post-thumb mb-3 d-block" href="blog-single.html">
						<img src="~/img/fashion/bg-fashion.jpg" alt="" class="img-fluid w-100">
					</a>
					<div class="meta-cat">
						<span class="letter-spacing cat-name font-extra text-uppercase font-sm">Experience</span>
					</div>
					<h3 class="post-title mt-2"><a href="blog-single.html">A guide to Duxton Hill</a></h3>

					<div class="post-meta footer-meta">
						<ul class="list-inline">
							<li class="post-like list-inline-item">
								<span class="font-sm letter-spacing-1 text-uppercase"><i class="ti-time mr-2"></i>2 min read</span>
							</li>
							<li class="post-view list-inline-item letter-spacing-1">189 Views</li>
						</ul>
					</div>
					<div class="post-content">
						<p>
							Lorem ipsum dolor sit amet, consectetur adipisicing elit.Magnam nesciunt architecto quaerat
							necessitatibus tenetur ratione eius numquam! elit. Earum in doloremque, odit quas repellat voluptatum
							illo nulla ullam sunt, enim animi eaque dolorem possimus saepe! Fuga voluptas sapiente, nemo sit.
						</p>

					</div>
				</article>

				
				@await Html.PartialAsync("~/Views/Posts/Index.cshtml", Model)
				
			</div>
			<div class="col-lg-4 col-md-8 col-sm-12 col-xs-12">
				<div class="sidebar sidebar-right">

					<div class="my-4 d-flex flex-column align-items-center text-center">
						@if (ViewBag.IsMember){
							<a asp-controller="Events" asp-action="Index" asp-route-clubID="@Model.ClubId" class="btn btn-primary btn-lg">
								<i class="fas fa-calendar-alt me-2"></i> View Club Events
							</a>
						}else{
							<a asp-controller="JoinRequests" asp-action="Create" asp-route-clubID="@Model.ClubId" class="btn btn-primary btn-lg">
								<i class="fas fa-calendar-alt me-2"></i> Join
							</a>
						}

						@if (User.IsInRole("Admin") && ViewBag.IsMember)
						{
							<a asp-controller="Posts" asp-action="ApprovePost" asp-route-clubId="@Model.ClubId" class="btn btn-primary btn-lg" style="margin-top:20px">
								<i class="fa-solid fa-check"></i> Approve post
							</a>
						}
					</div>

					<div class="sidebar-wrap mt-5 mt-lg-0">
						<div class="sidebar-widget about mb-5 p-3 text-center">
							<div class="about-author">
								<img src="@(string.IsNullOrEmpty(Model.LogoBase64) ? Url.Content("~/defaultPicture.jpg")  : Model.LogoBase64)"
									 alt="Logo picture"
									 class="img-fluid">

							</div>
							<h4 class="mb-0 mt-4">@Model.ClubName</h4>
							<p>
								@Model.Description
							</p>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>



